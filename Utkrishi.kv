#:import C kivy.utils.get_color_from_hex
#:import SearchBar components.SearchBar.SearchBar
#:import MapView kivy.garden.mapview.MapView
#:import MapSource kivy_garden.mapview.MapSource

<ButtonLayout>
    border_color: 0, 0, 0, 0
    FloatLayout:
        size_hint: 1, 1
        pos_hint: {"center_x": .5, "center_y": .5}
        canvas.before:
            Color:
                rgba: root.border_color  # Initial border color (transparent)
            Line:
                width: 1.5  # Border width
                rectangle: self.x, self.y, self.width, self.height

        
<IconListItem>

    IconLeftWidget:
        icon: root.icon
<NavButton>
    size_hint: None, None
    size: "45dp", "45dp"
    md_bg_color: 1,1,1,1
    radius: "15dp"
    icon: ""
    icon_size: "22dp"
    icon_color: C('#4CC955')
    pos_hint: {"center_x": .5, "center_y": .45}
                
    MDIcon:
        icon: root.icon
        font_size: root.icon_size
        color: root.icon_color
        size_hint: 1, 1
        halign: "center"
        pos_hint: {"center_x": .5, "center_y": .5}

<ProductCard>
    md_bg_color: c("#dbf1db")
    md_bg_color: C("#dbf1db")
    radius: "10dp"
    image: ""
    product_name: ""
    product_price: ""
    product_selling_unit: ""
    distance: "20 km"
    duration: "10 min"

    AsyncImage:
        id: product_img
        source: root.image
        size_hint: None, None
        size: "100dp", "130dp"
        radius: "10dp"
        y: root.y + root.height - self.height - dp(10)
        x: root.x + dp(10)
        canvas.before:
            Color:
                rgba: 1,1,1,1
            RoundedRectangle:
                size: self.size
                pos: self.pos
                radius: dp(10), dp(10), dp(10), dp(10)

    MDFloatLayout:
        id: product_info_layout
        size_hint: None, None
        size: self.parent.width - dp(130), "130dp"
        md_bg_color: 1,1,1,.5
        radius: "10dp"
        y: root.y + root.height - self.height - dp(10)
        x: product_img.x + product_img.width + dp(10)


        MDLabel:
            text: root.product_name
            halign: "left"
            pos_hint: {'x': .05, 'center_y': .8}
        
        MDLabel:
            text: "[b]₹"+root.product_price+"[/b][size=10]"+root.product_selling_unit+"[/size]"
            halign: "left"
            markup: True
            pos_hint: {'x': .05, 'center_y': .6}


    MDBoxLayout:
        size_hint: None, None
        size: "120dp", "30dp"
        md_bg_color: C("#dbf1db")
        radius: "10dp", 0, 0, 0
        pos_hint: {'right': 1}
        y: product_info_layout.y
        padding: dp(5), dp(5), dp(5), dp(5)

        MDFloatLayout:
            size_hint: None, None
            adaptive_height: True
            adaptive_width: True
            pos_hint: {'x': 0, 'center_y': .5}

            MDIcon:
                id: distance_icon
                icon: "road-variant"
                font_size: "12dp"
                color: C("#4CC955")
                size_hint: None, None
                width: dp(10)
                pos_hint: {"x": 0, "center_y": .5}

            MDLabel:
                id: distance_lb
                text: root.distance
                font_size: "12dp"
                size_hint: None, None
                width: dp(40)
                color: C("#4CC955")
                pos_hint: {"center_y": .5}
                x: distance_icon.x + distance_icon.width + dp(5)
            
            MDIcon:
                id: duration_icon
                icon: "clock"
                font_size: "12dp"
                color: C("#4CC955")
                size_hint: None, None
                width: dp(10)
                pos_hint: {"center_y": .5}
                x: distance_lb.x + distance_lb.width + dp(1)

            MDLabel:
                text: root.duration
                font_size: "12dp"
                color: C("#4CC955")
                size_hint: None, None
                width: dp(40)
                pos_hint: {"center_y": .5}
                x: duration_icon.x + duration_icon.width + dp(5)

<SectionProgressBar>
    current_section: first_section

    MDFloatLayout:
        id: first_section
        md_bg_color: root.section_color(first_section)
        size_hint: None, None
        size: "25dp", "25dp"
        radius: "15dp"
        pos_hint: {"x": 0, "center_y": .5}
        canvas.before:
            Color:
                rgba: C("#4CC955")
            Line:
                width: 1.5  # Border width
                rounded_rectangle: [self.x, self.y, self.width, self.height] + self.radius

        MDIcon:
            icon: "numeric-1"
            font_size: "20dp"
            pos_hint: {"center_x": .5, "center_y": .5}

    MDLabel:
        text: "Summery"
        font_size: "15dp"
        x: first_section.x-(first_section.width/2)
        y: root.y-(root.height/2)

    MDFloatLayout:
        size_hint: None, None
        height: "2dp"
        width: (self.parent.width/2) - dp(47.5)
        md_bg_color: C("#4CC955")
        pos_hint: {"center_y": .5}
        x: root.x+dp(30)

    MDFloatLayout:
        id: second_section
        md_bg_color: C("#dbf1db")
        size_hint: None, None
        size: "25dp", "25dp"
        radius: "15dp"
        pos_hint: {"center_x": .5, "center_y": .5}
        canvas.before:
            Color:
                rgba: C("#4CC955")
            Line:
                width: 1.5  # Border width
                rounded_rectangle: [self.x, self.y, self.width, self.height] + self.radius

        MDIcon:
            icon: "numeric-2"
            font_size: "20dp"
            color: C("#4CC955")
            pos_hint: {"center_x": .5, "center_y": .5}

    MDLabel:
        text: "Address"
        font_size: "15dp"
        x: second_section.x-(second_section.width/2)
        y: root.y-(root.height/2)
        
    MDFloatLayout:
        size_hint: None, None
        height: "2dp"
        width: (self.parent.width/2) - dp(47.5)
        md_bg_color: C("#4CC955")
        pos_hint: {"center_y": .5}
        x: self.parent.center_x + dp(17.5)

    MDFloatLayout:
        id: third_section
        md_bg_color: C("#dbf1db")
        size_hint: None, None
        size: "25dp", "25dp"
        radius: "15dp"
        pos_hint: {"right": 1, "center_y": .5}
        canvas.before:
            Color:
                rgba: C("#4CC955")
            Line:
                width: 1.5  # Border width
                rounded_rectangle: [self.x, self.y, self.width, self.height] + self.radius

        MDIcon:
            icon: "numeric-3"
            font_size: "20dp"
            color: C("#4CC955")
            pos_hint: {"center_x": .5, "center_y": .5}
    
    MDLabel:
        text: "Payment"
        font_size: "15dp"
        x: third_section.x-(third_section.width/2)
        y: root.y-(root.height/2)


<CirclarProgress>
    progress_bar_color: 0,0,0,0

    canvas.before:
        PushMatrix
        Rotate:
            angle: root.angle
            origin: self.center

    canvas.after:
        PopMatrix

    MDFloatLayout:
        size_hint: 1, 1
        pos_hint: {"center_x": .5, "center_y": .5}
    
        canvas.before:
            Color:
                rgba: root.progress_bar_color
            Line:
                width: 5
                circle: (self.center_x, self.center_y, min(self.width, self.height)/ 2, 0, 250)
            

<LanguageSelectionScreen>
    MDFloatLayout:
        md_bg_color: 1,1,1,1
        size_hint: 1, 1

        MDLabel:
            text: "Select Language"
            font_size: "24dp"
            bold: True
            color: C('#4CC955')
            pos_hint: { "center_y": .9}
            x: "24dp"
        
        MDBoxLayout:
            orientation: 'horizontal'
            size_hint: 1, None
            size: 0, "100dp"
            pos_hint: {"center_y": .7}

            Widget:
                size_hint: 1, 1

            ButtonLayout:
                id: tamil_lang_btn
                md_bg_color: C("#d9e9f8")
                size_hint: None, 1
                size: "125dp", "100dp"
                on_press: 
                    self.border_color = C("#4995dd")
                    eng_lang_btn.border_color = 0,0,0,0
                    hindi_lang_btn.border_color = 0,0,0,0
                    tal_lang_btn.border_color = 0,0,0,0
                    app.language = "Tamil"

                MDLabel:
                    text: "Tamil"
                    font_size: "14dp"
                    color: C("#4995dd")
                    adaptive_height: True
                    pos_hint: {"x": .1, "top": .95}
                    padding: "15db"

                MDLabel:
                    text: "அ"
                    font_name: "assets/fonts/Tamil_font.ttf"
                    font_script_name: "Taml"
                    font_size: "24dp"
                    color: C("#4995dd")
                    halign: "center"
                    pos_hint: {"center_x": .5, "center_y": .5}
                    padding: "15db"

                MDLabel:
                    text: "தமிழ் "
                    font_name: "assets/fonts/Tamil_font.ttf"
                    font_script_name: "Taml"
                    font_size: "14dp"
                    color: C("#4995dd")
                    adaptive_height: True
                    halign: "right"
                    size_hint_x: .8
                    pos_hint: {"center_x": .5, "y": .05}
                    padding: "15db"

            Widget:
                size_hint: 1, 1

            ButtonLayout:
                id: eng_lang_btn
                md_bg_color: C("#dbf1db")
                size_hint: None, None
                size: "125dp", "100dp"
                on_press: 
                    self.border_color = C("#4cb74c")
                    tamil_lang_btn.border_color = 0,0,0,0
                    hindi_lang_btn.border_color = 0,0,0,0
                    tal_lang_btn.border_color = 0,0,0,0
                    app.language = "English"

                MDLabel:
                    text: "English"
                    font_size: "14dp"
                    color: C("#4cb74c")
                    adaptive_height: True
                    pos_hint: {"x": .1, "top": .95}
                    padding: "15db"

                MDLabel:
                    text: "A"
                    font_size: "24dp"
                    color: C("#4cb74c")
                    halign: "center"
                    pos_hint: {"center_x": .5, "center_y": .5}

            Widget:
                size_hint: 1, 1

        MDBoxLayout:
            orientation: 'horizontal'
            size_hint: 1, None
            size: 0, "100dp"
            pos_hint: {"center_y": .5}

            Widget:
                size_hint: 1, 1

            ButtonLayout:
                id: hindi_lang_btn
                md_bg_color: C("#fdf2d2")
                size_hint: None, None
                size: "125dp", "100dp"
                pos_hint: {"x": .1, "center_y": .3}
                on_press: 
                    self.border_color = C("#f7d569")
                    eng_lang_btn.border_color = 0,0,0,0
                    tamil_lang_btn.border_color = 0,0,0,0
                    tal_lang_btn.border_color = 0,0,0,0
                    app.language = "Hindi"
                
                MDLabel:
                    text: "Hindi"
                    font_size: "14dp"
                    color: C("#f7d569")
                    adaptive_height: True
                    pos_hint: {"x": .1, "top": .95}
                    padding: "15db"

                MDLabel:
                    text: "अ"
                    font_name: "assets/fonts/Hindi_font.ttf"
                    font_size: "24dp"
                    color: C("#f7d569")
                    halign: "center"
                    pos_hint: {"center_x": .5, "center_y": .5}
                    padding: "15db"
                
                MDLabel:
                    text: "हिन्दी"
                    font_name: "assets/fonts/Hindi_font.ttf"
                    font_script_name: "Deva"
                    font_size: "14dp"
                    color: C("#f7d569")
                    adaptive_height: True
                    halign: "right"
                    size_hint_x: .8
                    pos_hint: {"center_x": .5, "y": .05}
                    padding: "15db"

            Widget:
                size_hint: 1, 1
            
            ButtonLayout:
                id: tal_lang_btn
                md_bg_color: C("#bae5eb")
                size_hint: None, None
                size: "125dp", "100dp"
                pos_hint: {"x": .1, "center_y": .3}
                on_press: 
                    self.border_color = C("#38b6c7")
                    eng_lang_btn.border_color = 0,0,0,0
                    tamil_lang_btn.border_color = 0,0,0,0
                    hindi_lang_btn.border_color = 0,0,0,0
                    app.language = "Telugu"
                
                MDLabel:
                    text: "Telugu"
                    font_size: "14dp"
                    color: C("#38b6c7")
                    adaptive_height: True
                    pos_hint: {"x": .1, "top": .95}
                    padding: "15db"

                MDLabel:
                    text: "అ"
                    font_name: "assets/fonts/Telugu_font.ttf"
                    font_size: "24dp"
                    color: C("#38b6c7")
                    halign: "center"
                    pos_hint: {"center_x": .5, "center_y": .5}
                    padding: "15db"
                
                MDLabel:
                    text: "తెలుగు   "
                    font_name: "assets/fonts/Telugu_font.ttf"
                    font_script_name: "Telu"
                    font_size: "14dp"
                    color: C("#38b6c7")
                    adaptive_height: True
                    halign: "right"
                    size_hint_x: .8
                    pos_hint: {"center_x": .5, "y": .05}

            Widget:
                size_hint: 1, 1

        MDRaisedButton:
            text: "Next"
            md_bg_color: C('#4CC955')
            size_hint_x: .9
            pos_hint: {"center_x": .5, "center_y": .1}
            on_release: root.change_screen()



<MainScreen>
    MDFloatLayout:
        md_bg_color: C("#ffffff")
        size_hint: 1, 1
         
        MDFloatLayout:
            id: main_layout

            MDScrollView:
                id: home_layout
                size_hint: 1, None
                height: self.parent.height - (navbar.height + search_bar_bg.height)
                do_scroll_x: False
                pos_hint: {"x": 0}
                y: search_bar_bg.y-self.height
                on_touch_down: if self.collide_point(*args[1].pos): root.scroll_touch_down(*args[1].pos, search_bar_bg, navbar, horizontal_scroll)
                on_touch_move: if self.collide_point(*args[1].pos): root.move_test(*args[1].pos, navbar)

                MDBoxLayout:
                    id: main_product_layout
                    orientation: 'vertical'
                    spacing: "10dp"
                    pos_hint: {"x": 0, "center_y": .5}
                    adaptive_height: True

                    Card:
                        md_bg_color: C('#ffffff')
                        elevation: 1
                        pos_hint: {"center_x": .5, "center_y": .5}
                        radius: "15dp"
                        size_hint: .98, None
                        size: 0, "150dp"

                        FitImage:
                            source: "bg.jpg"
                            radius: '15dp'
                            size_hint: 1, 1
                            pos_hint: {"center_x": .5, "center_y": .5}

                        MDFloatLayout:
                            md_bg_color: 0,0,0,.6
                            pos_hint: {"center_x": .5, "center_y": .5}
                            radius: "15dp"

                            MDLabel:
                                text: "Deal Of The Day"
                                color: C("#ffffff")
                                bold: True
                                font_size: "33dp"
                                pos_hint: {"center_x": .55, "center_y": .5}

                    ScrollView:
                        id: horizontal_scroll
                        size_hint: .98, None
                        size: 0, "100dp"
                        do_scroll_y: False
                        bar_color: 1,1,1,0
                        pos_hint: {"center_x": .5, "center_y": .5}

                        MDBoxLayout:
                            orientation: 'horizontal'
                            spacing: "10dp"
                            adaptive_width: True

                            Card:
                                size_hint: None, .95
                                width: "200dp"
                                md_bg_color: C('#ffffff')
                                elevation: 1
                                radius: "15dp"
                                pos_hint: {"center_x": .5, "center_y": .5}

                                FitImage:
                                    source: "vegetables_bg.jpg"
                                    radius: '15dp'
                                    size_hint: 1, 1
                                    pos_hint: {"center_x": .5, "center_y": .5}

                                MDFloatLayout:
                                    md_bg_color: 0,0,0,.6
                                    pos_hint: {"center_x": .5, "center_y": .5}
                                    radius: "15dp"

                                    MDLabel:
                                        text: "Veggies & Fruits"
                                        color: C("#ffffff")
                                        bold: True
                                        font_size: "22dp"
                                        pos_hint: {"center_x": .55, "center_y": .5}

                            Card:
                                size_hint: None, .95
                                width: "200dp"
                                md_bg_color: C('#ffffff')
                                elevation: 1
                                radius: "15dp"
                                pos_hint: {"center_x": .5, "center_y": .5}

                                FitImage:
                                    source: "dairy_bg.jpg"
                                    radius: '15dp'
                                    size_hint: 1, 1
                                    pos_hint: {"center_x": .5, "center_y": .5}

                                MDFloatLayout:
                                    md_bg_color: 0,0,0,.6
                                    pos_hint: {"center_x": .5, "center_y": .5}
                                    radius: "15dp"

                                    MDLabel:
                                        text: "Dairy Products"
                                        color: C("#ffffff")
                                        bold: True
                                        font_size: "22dp"
                                        pos_hint: {"center_x": .55, "center_y": .5}


                            Card:
                                size_hint: None, .95
                                width: "200dp"
                                md_bg_color: C('#ffffff')
                                elevation: 1
                                radius: "15dp"
                                pos_hint: {"center_x": .5, "center_y": .5}

                                FitImage:
                                    source: "pharmacy_bg.jpg"
                                    radius: '15dp'
                                    size_hint: 1, 1
                                    pos_hint: {"center_x": .5, "center_y": .5}

                                MDFloatLayout:
                                    md_bg_color: 0,0,0,.6
                                    pos_hint: {"center_x": .5, "center_y": .5}
                                    radius: "15dp"

                                    MDLabel:
                                        text: "Medicines"
                                        color: C("#ffffff")
                                        bold: True
                                        font_size: "22dp"
                                        pos_hint: {"center_x": .55, "center_y": .5}


                            Card:
                                size_hint: None, .95
                                width: "200dp"
                                md_bg_color: C('#ffffff')
                                elevation: 1
                                radius: "15dp"
                                pos_hint: {"center_x": .5, "center_y": .5}

                                FitImage:
                                    source: "groceries_bg.jpg"
                                    radius: '15dp'
                                    size_hint: 1, 1
                                    pos_hint: {"center_x": .5, "center_y": .5}

                                MDFloatLayout:
                                    md_bg_color: 0,0,0,.6
                                    pos_hint: {"center_x": .5, "center_y": .5}
                                    radius: "15dp"

                                    MDLabel:
                                        text: "Grocery"
                                        color: C("#ffffff")
                                        bold: True
                                        font_size: "22dp"
                                        pos_hint: {"center_x": .55, "center_y": .5}

                    
                    MDRelativeLayout:
                        md_bg_color: 0,1,0,1
                        size_hint: 1, .9
                        pos_hint: {'x': 1, 'top': 1}


            
            
            MDBoxLayout:
                id: cart_layout
                md_bg_color: 0,0,0.3,1      
                size_hint: 1, 1
                pos_hint: {"x": 1, "center_y": .5}
            
            MDBoxLayout:
                id: shopping_layout
                md_bg_color: 0,0,0.3,1
                size_hint: 1, 1
                pos_hint: {"x": -1, "center_y": .5}

                MDFloatLayout:
                    size_hint: 1, 1
                    
                    ShoppingMap:
                        id: shopping_map
                        map_source: "my-map"
                        lat: app.geo_cordinates[0]
                        lon: app.geo_cordinates[1]
                        zoom: 100
                        pos_hint: {'center_x': .5}
                        
                    Card:
                        id: product_list_layout
                        size_hint: 1, None
                        height: self.parent.height - search_bar_bg.height
                        md_bg_color: "white"
                        elevation: 1
                        radius: "15dp", "15dp", 0, 0
                        pos_hint: {'center_x': .5}
                        y: 0

                        MDFloatLayout:
                            id: drag_handler
                            size_hint: 1, None
                            size: 0, "50dp"
                            radius: "15dp", "15dp", 0, 0
                            pos_hint: {"center_x": .5, 'top': 1}
                            
                            MDFloatLayout:
                                size_hint: .2, None
                                size: 0, "5dp"
                                radius: "2.5dp"
                                md_bg_color: .7,.7,.7,1
                                pos_hint: {"center_x": .5, 'top': .6}

                        MDScrollView:
                            size_hint: 1, None
                            height: product_list_layout.height - drag_handler.height
                            pos_hint: {"center_x": .5, 'y': 0}

                            MDBoxLayout:
                                id: product_list_boxlayout
                                adaptive_height: True
                                pos_hint: {"center_x": .5}
                                padding: "20dp"


            
            MDBoxLayout:
                id: my_order_layout
                md_bg_color: 0.3,0,0,1  
                size_hint: 1, 1
                pos_hint: {"x": -2, "center_y": .5}

        MDFloatLayout:
            id: navbar
            md_bg_color: C("#ffffff")
            size_hint: 1, None
            size: 0, "60dp"
            pos_hint: {"center_x": .5}
            y: self.parent.height-self.height

            MDLabel:
                id: test_lb
                text: "Utkrishi"
                font_size: "18dp"
                bold: True
                color: 0,0,0,1
                pos_hint: {"x": .05, "y": .05}

            MDFillRoundFlatIconButton:
                id: location_btn
                icon: "map-marker-radius" 
                text: ""
                pos_hint: {"right": .95, "center_y": .5}
                md_bg_color: C("#dbf1db")
                theme_text_color: "Custom"
                theme_icon_color: "Custom"
                icon_color: C('#4CC955')
                text_color: C('#4CC955')
                size_hint: .2, .2
                on_press: root.change_screen()
        
        MDFloatLayout:
            id: search_bar_bg
            size_hint: 1, None
            md_bg_color: C("#ffffff")
            height: search_bar.height+(search_bar.height/2)
            pos_hint: {"center_x": .5}
            y: navbar.y-self.height
        
        Card:
            id: bottom_navbar
            md_bg_color: C('#ffffff')
            elevation: 1
            radius: "15dp", "15dp", 0, 0
            size_hint: 1, None
            size: 0, "60dp"

            MDBoxLayout:
                orientation: 'horizontal'
                size_hint: 1, 1
                Widget:
                    size_hint: 1, 1
                NavButton:
                    id: sack_btn
                    icon: "package"
                    icon_color: C('#8e6f5a') if my_order_layout.x != 0 else C('#4CC955')
                    icon_size: "22dp" if my_order_layout.x != 0 else "32dp"
                    pos_hint: {"center_x": .1, "center_y": .5}

                    ButtonLayout:
                        pos_hint: {"center_x": .5, "center_y": .5}
                        on_press: 
                            sack_btn.elevation = 1
                            sack_btn.icon_size = "18dp"
                            root.show_layout(my_order_layout)

                        on_release: 
                            sack_btn.elevation = 2
                            sack_btn.icon_size = "22dp" if my_order_layout.x != 0 else "32dp"

                Widget:
                    size_hint: 1, 1
                
                NavButton:
                    id: fruits_btn
                    icon: "shopping"
                    icon_color: C('#702cf6') if shopping_layout.x != 0 else C('#4CC955')
                    icon_size: "22dp" if shopping_layout.x != 0 else "32dp"
                    pos_hint: {"center_x": .3, "center_y": .5}

                    ButtonLayout:
                        pos_hint: {"center_x": .5, "center_y": .5}
                        on_press:
                            fruits_btn.icon_size = "18dp"
                            root.show_layout(shopping_layout)

                        on_release: 
                            fruits_btn.elevation = 2
                            fruits_btn.icon_size = "22dp" if shopping_layout.x != 0 else "32dp"
                
                Widget:
                    size_hint: 1, 1
                
                NavButton:
                    id: home_btn
                    icon: "home"
                    icon_color: C('#202124') if home_layout.x != 0 else C('#4CC955')
                    icon_size: "22dp" if home_layout.x != 0 else "32dp"
                    pos_hint: {"center_x": .5, "center_y": .5}

                    ButtonLayout:
                        pos_hint: {"center_x": .5, "center_y": .5}
                        on_press: 
                            home_btn.elevation = 1
                            home_btn.icon_size = "18dp"
                            root.show_layout(home_layout)

                        on_release: 
                            home_btn.elevation = 2
                            home_btn.icon_size = "22dp" if home_layout.x != 0 else "32dp"
                
                Widget:
                    size_hint: 1, 1
                
                NavButton:
                    id: cart_btn
                    icon: "cart"
                    icon_color: C("#949399") if cart_layout.x != 0 else C('#4CC955')
                    icon_size: "22dp" if cart_layout.x != 0 else "32dp"
                    pos_hint: {"center_x": .7, "center_y": .5}

                    ButtonLayout:
                        pos_hint: {"center_x": .5, "center_y": .5}
                        on_press: 
                            cart_btn.elevation = 1
                            cart_btn.icon_size = "18dp"
                            root.show_layout(cart_layout)

                        on_release: 
                            cart_btn.elevation = 2
                            cart_btn.icon_size = "22dp" if cart_layout.x != 0 else "32dp"

                Widget:
                    size_hint: 1, 1
        SearchBar:
            id: search_bar
            default_search_size_hint: .9, None
            default_search_size: 0, "40dp"
            search_text_field_size: 0, "60dp"
            open_search_size_hint: 1, 1
            default_radius: "10dp"
            border_color: C("#4cb74c")
            left_icon: "magnify"
            search_bar_color: "white"
            search_view_color: "white"
            pos_hint: {'center_x': .5}
            center_y: search_bar_bg.center_y
            on_search: root.search_product(shopping_layout, self.text)
            on_right_btn_press: app.start_listening(self)
            
<LoginScreen>
    MDFloatLayout:
        size_hint: 1, 1

        MDLabel:
            id: login_lb
            text: "Login"
            bold: True
            color: C('#4CC955')
            font_size: "33dp"
            pos_hint: {"center_x": .55, "center_y": .8}

        MDIconButton:
            icon: "arrow-left"
            x: login_lb.x - 20
            pos_hint: {"center_y": .95}
            on_press: root.change_screen()


        MDFloatLayout:
            size_hint: 1, 1

            MDIcon:
                icon: "email"
                pos_hint: {"x": .02, "center_y": .65}


            MDTextField:
                id: email_input
                hint_text: "Enter your email address..."
                line_color_focus: C('#4CC955')
                hint_text_color_focus: C('#4CC955')
                text_color_focus: C('#4CC955')
                text_color_normal: C('#4CC955')
                size_hint: None, None
                size: "250dp", "32dp"
                pos_hint: {"x": .1, "center_y": .65}

            MDIcon:
                icon: "key"
                pos_hint: {"x": .02, "center_y": .45}

            MDTextField:
                id: password_input
                hint_text: "Enter your password..."
                line_color_focus: C('#4CC955')
                hint_text_color_focus: C('#4CC955')
                text_color_focus: C('#4CC955')
                text_color_normal: C('#4CC955')
                password: True
                size_hint: None, None
                size: "250dp", "32dp"
                pos_hint: {"x": .1, "center_y": .45}

            MDDropDownItem:
                id: drop_item
                pos_hint: {'x': .1, 'center_y': .35}
                text: 'Select Your Login Type'
                on_release: app.menu.open()

        

            MDRaisedButton:
                text: "Login"
                md_bg_color: C('#4CC955')
                size_hint_x: .9
                pos_hint: {"center_x": .5, "center_y": .15}
                on_release: 
                    root.login(email_input.text, password_input.text)
                    app.loggedin = True

<AddProductsScreen>
    MDFloatLayout:
        size_hint: 1, 1
        md_bg_color:  1,1,1,1

        MDIconButton:
            icon: "arrow-left"
            x: "20dp"
            pos_hint: {"center_y": .95}
            on_press: root.change_screen()

        Card:
            size_hint: None, None
            elevation: 3
            radius: "20dp"
            md_bg_color: C('#ffffff')
            size: "200dp", "200dp"
            pos_hint: {"center_x": .5, "center_y": .8}

            MDIcon:
                icon: "plus"
                color: C("#717171")
                font_size: "100dp"
                pos_hint: {"center_x": .5, "center_y": .5}

            FitImage:
                id: product_img
                source: ""
                size_hint:1, 1
                radius: "20dp"
                pos_hint: {"center_x": .5, "center_y": .5}

            ButtonLayout:
                size_hint: 1, 1
                on_release: app.file_manager_open()
                pos_hint: {"center_x": .5, "center_y": .5}


        MDTextField:
            id: product_name_input
            hint_text: "Name of the Product..."
            line_color_focus: C('#4CC955')
            hint_text_color_focus: C('#4CC955')
            text_color_focus: C('#4CC955')
            text_color_normal: C('#4CC955')
            size_hint: None, None
            size: "250dp", "32dp"
            pos_hint: {"center_x": .5, "center_y": .45}

        MDTextField:
            id: product_price_input
            icon_left: "currency-rupee"
            hint_text: "Price"
            line_color_focus: C('#4CC955')
            hint_text_color_focus: C('#4CC955')
            text_color_focus: C('#4CC955')
            text_color_normal: C('#4CC955')
            icon_left_color_normal: C('#4CC955')
            icon_left_color_focus: C('#4CC955')
            size_hint: None, None
            size: "100dp", "32dp"
            pos_hint: {"center_x": .35, "center_y": .35}
        
        MDDropDownItem:
            id: unit_type_drop_down
            pos_hint: {"center_x": .65, "center_y": .35}
            text: '/Kg'
            on_release: app.unit_type_menu.open()

        MDDropDownItem:
            id: category_drop_item
            pos_hint: {'x': .1, 'center_y': .25}
            text: 'Category'
            on_release: app.pmenu.open()

        

        MDRaisedButton:
            text: "Enter"
            md_bg_color: C('#4CC955')
            size_hint_x: .9
            pos_hint: {"center_x": .5, "center_y": .15}
            on_release: 
                app.addproducts(product_img.source, product_name_input.text, product_price_input.text, unit_type_drop_down.current_item, category_drop_item.current_item)



<OrderSummeryScreen>
    md_bg_color: C("#ffffff")
    MDFloatLayout:
        size_hint: 1, 1
        md_bg_color: C("#ffffff")

        MDFloatLayout:
            id: navbar
            md_bg_color: 1,1,1,1
            size_hint: 1, None
            size: 0, "60dp"
            pos_hint: {"center_x": .5}
            y: self.parent.height-self.height

            MDLabel:
                text: "Order Summery"
                font_size: "18dp"
                bold: True
                color: 0,0,0,1
                x: back_btn.x + back_btn.width + dp(5)
                pos_hint: {"center_y": .5}

            
            MDIconButton:
                id: back_btn
                icon: "arrow-left"
                x: "5dp"
                pos_hint: {"center_y": .5}
                on_press: print(section_progress.ids.pos)
        
        SectionProgressBar:
            id: section_progress
            size_hint: .8, None
            height: "50dp"
            pos_hint: {"center_x": .5}
            y: self.parent.height - (navbar.height+self.height+dp(10))

            

<AddAddressScreen>
    MapView:
        id: my_address_map
        size_hint: 1, 1
        height: self.parent.height 
        pos_hint: {"center_x": .5, "center_y": .5}
        lat: app.geo_cordinates[0]
        lon: app.geo_cordinates[1]
        zoom: 100
        on_touch_up: if self.collide_point(*args[1].pos): root.add_pin(*args[1].pos)

        MapMarker:
            lat: app.geo_cordinates[0]
            lon: app.geo_cordinates[1]
            source: "assets/my_location.png"

    MDFloatLayout:
        id: processing_layout
        size_hint: 1, None
        height: my_address_map.height-dp(60)
        md_bg_color: 0, 0, 0, 0

        CirclarProgress:
            id: circlarprogress
            size_hint: None, None
            size: "80dp", "80dp"
            pos_hint: {'center_x': .5, 'center_y': .5}

    ButtonLayout:
        id: navbar
        md_bg_color: 1,1,1,1
        size_hint: 1, None
        size: 0, "60dp"
        pos_hint: {"center_x": .5}
        y: self.parent.height-self.height

        MDLabel:
            id: title_bar_address_lb
            text: "Pin Your Location"
            font_size: "18dp"
            bold: True
            color: 0,0,0,1
            x: back_btn.x + back_btn.width + dp(5)
            pos_hint: {"center_y": .5}

        
        MDIconButton:
            id: back_btn
            icon: "arrow-left"
            x: "5dp"
            pos_hint: {"center_y": .5}
            on_press: root.change_screen()

    ButtonLayout:
        id: address_layout
        size_hint: 1, None
        height: self.parent.height-navbar.height
        md_bg_color:  1,1,1,1
        y: 0-self.parent.height


        MDBoxLayout:
            orientation: 'vertical'
            size_hint: 1, .9
            pos_hint: {"center_x": .5, "top": 1}

            Widget:
                size_hint: .1, .5

            MDBoxLayout:
                orientation: 'horizontal'
                size_hint: 1, None
                size: 0, "40dp"

                Widget:
                    id: space_refrence
                    size_hint: .1, 1

                ButtonLayout:
                    orientation: 'horizontal'
                    size_hint: 1, 1
                    on_press: print("Address Layout")
                    md_bg_color: C("#25A6FF")
                    radius: "10dp"

                    MDIcon:
                        icon: "map-marker-radius"
                        color: C('#ffffff')
                        pos_hint: {"x": .15, "center_y": .5}

                    MDLabel:
                        text: "Pin Location"
                        font_size: "18dp"
                        bold: True
                        halign: "center"
                        color: C('#ffffff')
                        pos_hint: {"x": 0, "center_y": .5}


                Widget:
                    size_hint: .1, 1

            Widget:
                size_hint: .1, .2
            Widget:
                size_hint: .1, 1

            MDBoxLayout:
                orientation: 'horizontal'
                size_hint: 1, None
                size: 0, "40dp"

                Widget:
                    id: space_refrence
                    size_hint: .1, 1

                MDTextField:
                    id: name_input
                    hint_text: "Name"
                    input_type: "text"
                    line_color_focus: C('#4CC955')
                    hint_text_color_focus: C('#4CC955')
                    text_color_focus: C('#4CC955')
                    text_color_normal: C('#4CC955')

                Widget:
                    size_hint: .1, 1

            Widget:
                size_hint: .1, 1
            
            
            
            MDBoxLayout:
                orientation: 'horizontal'
                size_hint: 1, None
                size: 0, "40dp"

                Widget:
                    id: space_refrence
                    size_hint: .1, 1

                MDTextField:
                    id: house_input
                    hint_text: "House No, Building Name"
                    input_type: "text"
                    line_color_focus: C('#4CC955')
                    hint_text_color_focus: C('#4CC955')
                    text_color_focus: C('#4CC955')
                    text_color_normal: C('#4CC955')

                Widget:
                    size_hint: .1, 1

            Widget:
                size_hint: .1, 1
            
            MDBoxLayout:
                orientation: 'horizontal'
                size_hint: 1, None
                size: 0, "40dp"

                Widget:
                    size_hint: .1, 1

                MDTextField:
                    id: street_input
                    hint_text: "Street Name, Area"
                    input_type: "text"
                    line_color_focus: C('#4CC955')
                    hint_text_color_focus: C('#4CC955')
                    text_color_focus: C('#4CC955')
                    text_color_normal: C('#4CC955')
                
                Widget:
                    size_hint: .1, 1

            Widget:
                size_hint: .1, 1

            MDBoxLayout:
                orientation: 'horizontal'
                size_hint: 1, None
                size: 0, "40dp"

                Widget:
                    size_hint: None, 1
                    width: space_refrence.width

                MDTextField:
                    id: state_input
                    hint_text: "State"
                    input_type: "text"
                    line_color_focus: C('#4CC955')
                    hint_text_color_focus: C('#4CC955')
                    text_color_focus: C('#4CC955')
                    text_color_normal: C('#4CC955')
                
                Widget:
                    size_hint: None, 1
                    width: space_refrence.width
                
                MDTextField:
                    id: city_input
                    hint_text: "City"
                    input_type: "text"
                    line_color_focus: C('#4CC955')
                    hint_text_color_focus: C('#4CC955')
                    text_color_focus: C('#4CC955')
                    text_color_normal: C('#4CC955')

                Widget:
                    size_hint: None, 1
                    width: space_refrence.width


            Widget:
                size_hint: .1, 1
            
            MDBoxLayout:
                orientation: 'horizontal'
                size_hint: 1, None
                size: 0, "40dp"

                Widget:
                    size_hint: .1, 1

                MDTextField:
                    id: pincode_input
                    hint_text: "PinCode"
                    input_type: "number"
                    line_color_focus: C('#4CC955')
                    hint_text_color_focus: C('#4CC955')
                    text_color_focus: C('#4CC955')
                    text_color_normal: C('#4CC955')
                    size_hint_x: .5
                
                Widget:
                    size_hint: .1, 1

            Widget:
                size_hint: .1, 1


        MDRaisedButton:
            text: "Save"
            md_bg_color: C('#4CC955')
            size_hint_x: .9
            pos_hint: {"center_x": .5, "center_y": .15}
            on_release: 
                app.saveaddress(name_input.text, house_input.text, street_input.text, state_input.text, city_input.text, pincode_input.text)
